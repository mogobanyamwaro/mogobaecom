{"ast":null,"code":"import _slicedToArray from\"/home/douglas/Downloads/ProShop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useEffect}from'react';import{Carousel}from'react-bootstrap';import Loader from'../layout/Loader';import MetaData from'../layout/MetaData';import ListReviews from'../review/ListReviews';import{useAlert}from'react-alert';import{useDispatch,useSelector}from'react-redux';import{getProductDetails,newReview,clearErrors}from'../../actions/productActions';import{addItemToCart}from'../../actions/cartActions';import{NEW_REVIEW_RESET}from'../../constants/productConstants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ProductDetails=function ProductDetails(_ref){var match=_ref.match;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),quantity=_useState2[0],setQuantity=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),rating=_useState4[0],setRating=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),comment=_useState6[0],setComment=_useState6[1];var dispatch=useDispatch();var alert=useAlert();var _useSelector=useSelector(function(state){return state.productDetails;}),loading=_useSelector.loading,error=_useSelector.error,product=_useSelector.product;var _useSelector2=useSelector(function(state){return state.auth;}),user=_useSelector2.user;var _useSelector3=useSelector(function(state){return state.newReview;}),reviewError=_useSelector3.error,success=_useSelector3.success;useEffect(function(){dispatch(getProductDetails(match.params.id));if(error){alert.error(error);dispatch(clearErrors());}if(reviewError){alert.error(reviewError);dispatch(clearErrors());}if(success){alert.success('Reivew posted successfully');dispatch({type:NEW_REVIEW_RESET});}},[dispatch,alert,error,reviewError,match.params.id,success]);var addToCart=function addToCart(){dispatch(addItemToCart(match.params.id,quantity));alert.success('Item Added to Cart');};var increaseQty=function increaseQty(){var count=document.querySelector('.count');if(count.valueAsNumber>=product.stock)return;var qty=count.valueAsNumber+1;setQuantity(qty);};var decreaseQty=function decreaseQty(){var count=document.querySelector('.count');if(count.valueAsNumber<=1)return;var qty=count.valueAsNumber-1;setQuantity(qty);};function setUserRatings(){var stars=document.querySelectorAll('.star');stars.forEach(function(star,index){star.starValue=index+1;['click','mouseover','mouseout'].forEach(function(e){star.addEventListener(e,showRatings);});});function showRatings(e){var _this=this;stars.forEach(function(star,index){if(e.type==='click'){if(index<_this.starValue){star.classList.add('orange');setRating(_this.starValue);}else{star.classList.remove('orange');}}if(e.type==='mouseover'){if(index<_this.starValue){star.classList.add('yellow');}else{star.classList.remove('yellow');}}if(e.type==='mouseout'){star.classList.remove('yellow');}});}}var reviewHandler=function reviewHandler(){var formData=new FormData();formData.set('rating',rating);formData.set('comment',comment);formData.set('productId',match.params.id);dispatch(newReview(formData));};return/*#__PURE__*/_jsx(Fragment,{children:loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MetaData,{title:product.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"row d-flex justify-content-around\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-lg-5 img-fluid\",id:\"product_image\",children:/*#__PURE__*/_jsx(Carousel,{pause:\"hover\",children:product.images&&product.images.map(function(image){return/*#__PURE__*/_jsx(Carousel.Item,{children:/*#__PURE__*/_jsx(\"img\",{className:\"d-block w-100\",src:image.url,alt:product.title})},image.public_id);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 col-lg-5 mt-5\",children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_id\",children:[\"Product # \",product._id]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"rating-outer\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating-inner\",style:{width:\"\".concat(product.ratings/5*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{id:\"no_of_reviews\",children:[\"(\",product.numOfReviews,\" Reviews)\"]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_price\",children:[\"$\",product.price]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stockCounter d-inline\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-danger minus\",onClick:decreaseQty,children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control count d-inline\",value:quantity,readOnly:true}),/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-primary plus\",onClick:increaseQty,children:\"+\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",id:\"cart_btn\",className:\"btn btn-primary d-inline ml-4\",disabled:product.stock===0,onClick:addToCart,children:\"Add to Cart\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status:\",' ',/*#__PURE__*/_jsx(\"span\",{id:\"stock_status\",className:product.stock>0?'greenColor':'redColor',children:product.stock>0?'In Stock':'Out of Stock'})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Quantity:\",' ',/*#__PURE__*/_jsx(\"span\",{id:\"quantity_status\",className:product.stock>0?'greenColor':'redColor',children:product.stock})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-2\",children:\"Description:\"}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_seller mb-3\",children:[\"Sold by: \",/*#__PURE__*/_jsx(\"strong\",{children:product.seller})]}),user?/*#__PURE__*/_jsx(\"button\",{id:\"review_btn\",type:\"button\",className:\"btn btn-primary mt-4\",\"data-toggle\":\"modal\",\"data-target\":\"#ratingModal\",onClick:setUserRatings,children:\"Submit Your Review\"}):/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mt-5\",type:\"alert\",children:\"Login to post your review.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row mt-2 mb-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating w-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\",id:\"ratingModal\",tabIndex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"ratingModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",role:\"document\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",id:\"ratingModalLabel\",children:\"Submit Review\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"ul\",{className:\"stars\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})})]}),/*#__PURE__*/_jsx(\"textarea\",{name:\"review\",id:\"review\",className:\"form-control mt-3\",value:comment,onChange:function onChange(e){return setComment(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn my-3 float-right review-btn px-4 text-white\",onClick:reviewHandler,\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:\"Submit\"})]})]})})})})})]})]}),product.reviews&&product.reviews.length>0&&/*#__PURE__*/_jsx(ListReviews,{reviews:product.reviews})]})});};export default ProductDetails;","map":{"version":3,"sources":["/home/douglas/Downloads/ProShop/frontend/src/components/product/ProductDetails.js"],"names":["React","Fragment","useState","useEffect","Carousel","Loader","MetaData","ListReviews","useAlert","useDispatch","useSelector","getProductDetails","newReview","clearErrors","addItemToCart","NEW_REVIEW_RESET","ProductDetails","match","quantity","setQuantity","rating","setRating","comment","setComment","dispatch","alert","state","productDetails","loading","error","product","auth","user","reviewError","success","params","id","type","addToCart","increaseQty","count","document","querySelector","valueAsNumber","stock","qty","decreaseQty","setUserRatings","stars","querySelectorAll","forEach","star","index","starValue","e","addEventListener","showRatings","classList","add","remove","reviewHandler","formData","FormData","set","name","images","map","image","url","title","public_id","_id","width","ratings","numOfReviews","price","description","seller","target","value","reviews","length"],"mappings":"+JAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,QAA1B,CAAoCC,SAApC,KAAqD,OAArD,CACA,OAASC,QAAT,KAAyB,iBAAzB,CAEA,MAAOC,CAAAA,MAAP,KAAmB,kBAAnB,CACA,MAAOC,CAAAA,QAAP,KAAqB,oBAArB,CACA,MAAOC,CAAAA,WAAP,KAAwB,uBAAxB,CAEA,OAASC,QAAT,KAAyB,aAAzB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OACEC,iBADF,CAEEC,SAFF,CAGEC,WAHF,KAIO,8BAJP,CAKA,OAASC,aAAT,KAA8B,2BAA9B,CACA,OAASC,gBAAT,KAAiC,kCAAjC,C,wFAEA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,MAAe,IAAZC,CAAAA,KAAY,MAAZA,KAAY,CACpC,cAAgCf,QAAQ,CAAC,CAAD,CAAxC,wCAAOgB,QAAP,eAAiBC,WAAjB,eACA,eAA4BjB,QAAQ,CAAC,CAAD,CAApC,yCAAOkB,MAAP,eAAeC,SAAf,eACA,eAA8BnB,QAAQ,CAAC,EAAD,CAAtC,yCAAOoB,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,QAAQ,CAAGf,WAAW,EAA5B,CACA,GAAMgB,CAAAA,KAAK,CAAGjB,QAAQ,EAAtB,CAEA,iBAAoCE,WAAW,CAC7C,SAACgB,KAAD,QAAWA,CAAAA,KAAK,CAACC,cAAjB,EAD6C,CAA/C,CAAQC,OAAR,cAAQA,OAAR,CAAiBC,KAAjB,cAAiBA,KAAjB,CAAwBC,OAAxB,cAAwBA,OAAxB,CAGA,kBAAiBpB,WAAW,CAAC,SAACgB,KAAD,QAAWA,CAAAA,KAAK,CAACK,IAAjB,EAAD,CAA5B,CAAQC,IAAR,eAAQA,IAAR,CACA,kBAAwCtB,WAAW,CACjD,SAACgB,KAAD,QAAWA,CAAAA,KAAK,CAACd,SAAjB,EADiD,CAAnD,CAAeqB,WAAf,eAAQJ,KAAR,CAA4BK,OAA5B,eAA4BA,OAA5B,CAIA/B,SAAS,CAAC,UAAM,CACdqB,QAAQ,CAACb,iBAAiB,CAACM,KAAK,CAACkB,MAAN,CAAaC,EAAd,CAAlB,CAAR,CAEA,GAAIP,KAAJ,CAAW,CACTJ,KAAK,CAACI,KAAN,CAAYA,KAAZ,EACAL,QAAQ,CAACX,WAAW,EAAZ,CAAR,CACD,CAED,GAAIoB,WAAJ,CAAiB,CACfR,KAAK,CAACI,KAAN,CAAYI,WAAZ,EACAT,QAAQ,CAACX,WAAW,EAAZ,CAAR,CACD,CAED,GAAIqB,OAAJ,CAAa,CACXT,KAAK,CAACS,OAAN,CAAc,4BAAd,EACAV,QAAQ,CAAC,CAAEa,IAAI,CAAEtB,gBAAR,CAAD,CAAR,CACD,CACF,CAjBQ,CAiBN,CAACS,QAAD,CAAWC,KAAX,CAAkBI,KAAlB,CAAyBI,WAAzB,CAAsChB,KAAK,CAACkB,MAAN,CAAaC,EAAnD,CAAuDF,OAAvD,CAjBM,CAAT,CAmBA,GAAMI,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtBd,QAAQ,CAACV,aAAa,CAACG,KAAK,CAACkB,MAAN,CAAaC,EAAd,CAAkBlB,QAAlB,CAAd,CAAR,CACAO,KAAK,CAACS,OAAN,CAAc,oBAAd,EACD,CAHD,CAKA,GAAMK,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxB,GAAMC,CAAAA,KAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAd,CAEA,GAAIF,KAAK,CAACG,aAAN,EAAuBb,OAAO,CAACc,KAAnC,CAA0C,OAE1C,GAAMC,CAAAA,GAAG,CAAGL,KAAK,CAACG,aAAN,CAAsB,CAAlC,CACAxB,WAAW,CAAC0B,GAAD,CAAX,CACD,CAPD,CASA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxB,GAAMN,CAAAA,KAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAd,CAEA,GAAIF,KAAK,CAACG,aAAN,EAAuB,CAA3B,CAA8B,OAE9B,GAAME,CAAAA,GAAG,CAAGL,KAAK,CAACG,aAAN,CAAsB,CAAlC,CACAxB,WAAW,CAAC0B,GAAD,CAAX,CACD,CAPD,CASA,QAASE,CAAAA,cAAT,EAA0B,CACxB,GAAMC,CAAAA,KAAK,CAAGP,QAAQ,CAACQ,gBAAT,CAA0B,OAA1B,CAAd,CAEAD,KAAK,CAACE,OAAN,CAAc,SAACC,IAAD,CAAOC,KAAP,CAAiB,CAC7BD,IAAI,CAACE,SAAL,CAAiBD,KAAK,CAAG,CAAzB,CAEA,CAAC,OAAD,CAAU,WAAV,CAAuB,UAAvB,EAAmCF,OAAnC,CAA2C,SAAUI,CAAV,CAAa,CACtDH,IAAI,CAACI,gBAAL,CAAsBD,CAAtB,CAAyBE,WAAzB,EACD,CAFD,EAGD,CAND,EAQA,QAASA,CAAAA,WAAT,CAAqBF,CAArB,CAAwB,gBACtBN,KAAK,CAACE,OAAN,CAAc,SAACC,IAAD,CAAOC,KAAP,CAAiB,CAC7B,GAAIE,CAAC,CAACjB,IAAF,GAAW,OAAf,CAAwB,CACtB,GAAIe,KAAK,CAAG,KAAI,CAACC,SAAjB,CAA4B,CAC1BF,IAAI,CAACM,SAAL,CAAeC,GAAf,CAAmB,QAAnB,EAEArC,SAAS,CAAC,KAAI,CAACgC,SAAN,CAAT,CACD,CAJD,IAIO,CACLF,IAAI,CAACM,SAAL,CAAeE,MAAf,CAAsB,QAAtB,EACD,CACF,CAED,GAAIL,CAAC,CAACjB,IAAF,GAAW,WAAf,CAA4B,CAC1B,GAAIe,KAAK,CAAG,KAAI,CAACC,SAAjB,CAA4B,CAC1BF,IAAI,CAACM,SAAL,CAAeC,GAAf,CAAmB,QAAnB,EACD,CAFD,IAEO,CACLP,IAAI,CAACM,SAAL,CAAeE,MAAf,CAAsB,QAAtB,EACD,CACF,CAED,GAAIL,CAAC,CAACjB,IAAF,GAAW,UAAf,CAA2B,CACzBc,IAAI,CAACM,SAAL,CAAeE,MAAf,CAAsB,QAAtB,EACD,CACF,CAtBD,EAuBD,CACF,CAED,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1B,GAAMC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAjB,CAEAD,QAAQ,CAACE,GAAT,CAAa,QAAb,CAAuB3C,MAAvB,EACAyC,QAAQ,CAACE,GAAT,CAAa,SAAb,CAAwBzC,OAAxB,EACAuC,QAAQ,CAACE,GAAT,CAAa,WAAb,CAA0B9C,KAAK,CAACkB,MAAN,CAAaC,EAAvC,EAEAZ,QAAQ,CAACZ,SAAS,CAACiD,QAAD,CAAV,CAAR,CACD,CARD,CAUA,mBACE,KAAC,QAAD,WACGjC,OAAO,cACN,KAAC,MAAD,IADM,cAGN,MAAC,QAAD,yBACE,KAAC,QAAD,EAAU,KAAK,CAAEE,OAAO,CAACkC,IAAzB,EADF,cAEE,aAAK,SAAS,CAAC,mCAAf,wBACE,YAAK,SAAS,CAAC,2BAAf,CAA2C,EAAE,CAAC,eAA9C,uBACE,KAAC,QAAD,EAAU,KAAK,CAAC,OAAhB,UACGlC,OAAO,CAACmC,MAAR,EACCnC,OAAO,CAACmC,MAAR,CAAeC,GAAf,CAAmB,SAACC,KAAD,qBACjB,KAAC,QAAD,CAAU,IAAV,wBACE,YACE,SAAS,CAAC,eADZ,CAEE,GAAG,CAAEA,KAAK,CAACC,GAFb,CAGE,GAAG,CAAEtC,OAAO,CAACuC,KAHf,EADF,EAAoBF,KAAK,CAACG,SAA1B,CADiB,EAAnB,CAFJ,EADF,EADF,cAgBE,aAAK,SAAS,CAAC,sBAAf,wBACE,oBAAKxC,OAAO,CAACkC,IAAb,EADF,cAEE,WAAG,EAAE,CAAC,YAAN,wBAA8BlC,OAAO,CAACyC,GAAtC,GAFF,cAIE,aAJF,cAME,YAAK,SAAS,CAAC,cAAf,uBACE,YACE,SAAS,CAAC,cADZ,CAEE,KAAK,CAAE,CAAEC,KAAK,WAAM1C,OAAO,CAAC2C,OAAR,CAAkB,CAAnB,CAAwB,GAA7B,KAAP,CAFT,EADF,EANF,cAYE,cAAM,EAAE,CAAC,eAAT,eAA2B3C,OAAO,CAAC4C,YAAnC,eAZF,cAcE,aAdF,cAgBE,WAAG,EAAE,CAAC,eAAN,eAAwB5C,OAAO,CAAC6C,KAAhC,GAhBF,cAiBE,aAAK,SAAS,CAAC,uBAAf,wBACE,aAAM,SAAS,CAAC,sBAAhB,CAAuC,OAAO,CAAE7B,WAAhD,eADF,cAKE,cACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,6BAFZ,CAGE,KAAK,CAAE5B,QAHT,CAIE,QAAQ,KAJV,EALF,cAYE,aAAM,SAAS,CAAC,sBAAhB,CAAuC,OAAO,CAAEqB,WAAhD,eAZF,GAjBF,cAiCE,eACE,IAAI,CAAC,QADP,CAEE,EAAE,CAAC,UAFL,CAGE,SAAS,CAAC,+BAHZ,CAIE,QAAQ,CAAET,OAAO,CAACc,KAAR,GAAkB,CAJ9B,CAKE,OAAO,CAAEN,SALX,yBAjCF,cA2CE,aA3CF,cA6CE,+BACU,GADV,cAEE,aACE,EAAE,CAAC,cADL,CAEE,SAAS,CAAER,OAAO,CAACc,KAAR,CAAgB,CAAhB,CAAoB,YAApB,CAAmC,UAFhD,UAIGd,OAAO,CAACc,KAAR,CAAgB,CAAhB,CAAoB,UAApB,CAAiC,cAJpC,EAFF,GA7CF,cAuDE,aAvDF,cAyDE,iCACY,GADZ,cAEE,aACE,EAAE,CAAC,iBADL,CAEE,SAAS,CAAEd,OAAO,CAACc,KAAR,CAAgB,CAAhB,CAAoB,YAApB,CAAmC,UAFhD,UAIGd,OAAO,CAACc,KAJX,EAFF,GAzDF,cAmEE,aAnEF,cAqEE,WAAI,SAAS,CAAC,MAAd,0BArEF,cAsEE,mBAAId,OAAO,CAAC8C,WAAZ,EAtEF,cAuEE,aAvEF,cAwEE,WAAG,EAAE,CAAC,qBAAN,oCACW,wBAAS9C,OAAO,CAAC+C,MAAjB,EADX,GAxEF,CA4EG7C,IAAI,cACH,eACE,EAAE,CAAC,YADL,CAEE,IAAI,CAAC,QAFP,CAGE,SAAS,CAAC,sBAHZ,CAIE,cAAY,OAJd,CAKE,cAAY,cALd,CAME,OAAO,CAAEe,cANX,gCADG,cAYH,YAAK,SAAS,CAAC,yBAAf,CAAyC,IAAI,CAAC,OAA9C,wCAxFJ,cA6FE,YAAK,SAAS,CAAC,eAAf,uBACE,YAAK,SAAS,CAAC,aAAf,uBACE,YACE,SAAS,CAAC,YADZ,CAEE,EAAE,CAAC,aAFL,CAGE,QAAQ,CAAC,IAHX,CAIE,IAAI,CAAC,QAJP,CAKE,kBAAgB,kBALlB,CAME,cAAY,MANd,uBAQE,YAAK,SAAS,CAAC,cAAf,CAA8B,IAAI,CAAC,UAAnC,uBACE,aAAK,SAAS,CAAC,eAAf,wBACE,aAAK,SAAS,CAAC,cAAf,wBACE,WAAI,SAAS,CAAC,aAAd,CAA4B,EAAE,CAAC,kBAA/B,2BADF,cAIE,eACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,OAFZ,CAGE,eAAa,OAHf,CAIE,aAAW,OAJb,uBAME,aAAM,cAAY,MAAlB,kBANF,EAJF,GADF,cAcE,aAAK,SAAS,CAAC,YAAf,wBACE,YAAI,SAAS,CAAC,OAAd,wBACE,WAAI,SAAS,CAAC,MAAd,uBACE,UAAG,SAAS,CAAC,YAAb,EADF,EADF,cAIE,WAAI,SAAS,CAAC,MAAd,uBACE,UAAG,SAAS,CAAC,YAAb,EADF,EAJF,cAOE,WAAI,SAAS,CAAC,MAAd,uBACE,UAAG,SAAS,CAAC,YAAb,EADF,EAPF,cAUE,WAAI,SAAS,CAAC,MAAd,uBACE,UAAG,SAAS,CAAC,YAAb,EADF,EAVF,cAaE,WAAI,SAAS,CAAC,MAAd,uBACE,UAAG,SAAS,CAAC,YAAb,EADF,EAbF,GADF,cAmBE,iBACE,IAAI,CAAC,QADP,CAEE,EAAE,CAAC,QAFL,CAGE,SAAS,CAAC,mBAHZ,CAIE,KAAK,CAAEzB,OAJT,CAKE,QAAQ,CAAE,kBAACgC,CAAD,QAAO/B,CAAAA,UAAU,CAAC+B,CAAC,CAACwB,MAAF,CAASC,KAAV,CAAjB,EALZ,EAnBF,cA2BE,eACE,SAAS,CAAC,iDADZ,CAEE,OAAO,CAAEnB,aAFX,CAGE,eAAa,OAHf,CAIE,aAAW,OAJb,oBA3BF,GAdF,GADF,EARF,EADF,EADF,EA7FF,GAhBF,GAFF,CAoLG9B,OAAO,CAACkD,OAAR,EAAmBlD,OAAO,CAACkD,OAAR,CAAgBC,MAAhB,CAAyB,CAA5C,eACC,KAAC,WAAD,EAAa,OAAO,CAAEnD,OAAO,CAACkD,OAA9B,EArLJ,GAJJ,EADF,CAgMD,CA1SD,CA4SA,cAAehE,CAAAA,cAAf","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react';\nimport { Carousel } from 'react-bootstrap';\n\nimport Loader from '../layout/Loader';\nimport MetaData from '../layout/MetaData';\nimport ListReviews from '../review/ListReviews';\n\nimport { useAlert } from 'react-alert';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  getProductDetails,\n  newReview,\n  clearErrors,\n} from '../../actions/productActions';\nimport { addItemToCart } from '../../actions/cartActions';\nimport { NEW_REVIEW_RESET } from '../../constants/productConstants';\n\nconst ProductDetails = ({ match }) => {\n  const [quantity, setQuantity] = useState(1);\n  const [rating, setRating] = useState(0);\n  const [comment, setComment] = useState('');\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n\n  const { loading, error, product } = useSelector(\n    (state) => state.productDetails\n  );\n  const { user } = useSelector((state) => state.auth);\n  const { error: reviewError, success } = useSelector(\n    (state) => state.newReview\n  );\n\n  useEffect(() => {\n    dispatch(getProductDetails(match.params.id));\n\n    if (error) {\n      alert.error(error);\n      dispatch(clearErrors());\n    }\n\n    if (reviewError) {\n      alert.error(reviewError);\n      dispatch(clearErrors());\n    }\n\n    if (success) {\n      alert.success('Reivew posted successfully');\n      dispatch({ type: NEW_REVIEW_RESET });\n    }\n  }, [dispatch, alert, error, reviewError, match.params.id, success]);\n\n  const addToCart = () => {\n    dispatch(addItemToCart(match.params.id, quantity));\n    alert.success('Item Added to Cart');\n  };\n\n  const increaseQty = () => {\n    const count = document.querySelector('.count');\n\n    if (count.valueAsNumber >= product.stock) return;\n\n    const qty = count.valueAsNumber + 1;\n    setQuantity(qty);\n  };\n\n  const decreaseQty = () => {\n    const count = document.querySelector('.count');\n\n    if (count.valueAsNumber <= 1) return;\n\n    const qty = count.valueAsNumber - 1;\n    setQuantity(qty);\n  };\n\n  function setUserRatings() {\n    const stars = document.querySelectorAll('.star');\n\n    stars.forEach((star, index) => {\n      star.starValue = index + 1;\n\n      ['click', 'mouseover', 'mouseout'].forEach(function (e) {\n        star.addEventListener(e, showRatings);\n      });\n    });\n\n    function showRatings(e) {\n      stars.forEach((star, index) => {\n        if (e.type === 'click') {\n          if (index < this.starValue) {\n            star.classList.add('orange');\n\n            setRating(this.starValue);\n          } else {\n            star.classList.remove('orange');\n          }\n        }\n\n        if (e.type === 'mouseover') {\n          if (index < this.starValue) {\n            star.classList.add('yellow');\n          } else {\n            star.classList.remove('yellow');\n          }\n        }\n\n        if (e.type === 'mouseout') {\n          star.classList.remove('yellow');\n        }\n      });\n    }\n  }\n\n  const reviewHandler = () => {\n    const formData = new FormData();\n\n    formData.set('rating', rating);\n    formData.set('comment', comment);\n    formData.set('productId', match.params.id);\n\n    dispatch(newReview(formData));\n  };\n\n  return (\n    <Fragment>\n      {loading ? (\n        <Loader />\n      ) : (\n        <Fragment>\n          <MetaData title={product.name} />\n          <div className='row d-flex justify-content-around'>\n            <div className='col-12 col-lg-5 img-fluid' id='product_image'>\n              <Carousel pause='hover'>\n                {product.images &&\n                  product.images.map((image) => (\n                    <Carousel.Item key={image.public_id}>\n                      <img\n                        className='d-block w-100'\n                        src={image.url}\n                        alt={product.title}\n                      />\n                    </Carousel.Item>\n                  ))}\n              </Carousel>\n            </div>\n\n            <div className='col-12 col-lg-5 mt-5'>\n              <h3>{product.name}</h3>\n              <p id='product_id'>Product # {product._id}</p>\n\n              <hr />\n\n              <div className='rating-outer'>\n                <div\n                  className='rating-inner'\n                  style={{ width: `${(product.ratings / 5) * 100}%` }}\n                ></div>\n              </div>\n              <span id='no_of_reviews'>({product.numOfReviews} Reviews)</span>\n\n              <hr />\n\n              <p id='product_price'>${product.price}</p>\n              <div className='stockCounter d-inline'>\n                <span className='btn btn-danger minus' onClick={decreaseQty}>\n                  -\n                </span>\n\n                <input\n                  type='number'\n                  className='form-control count d-inline'\n                  value={quantity}\n                  readOnly\n                />\n\n                <span className='btn btn-primary plus' onClick={increaseQty}>\n                  +\n                </span>\n              </div>\n              <button\n                type='button'\n                id='cart_btn'\n                className='btn btn-primary d-inline ml-4'\n                disabled={product.stock === 0}\n                onClick={addToCart}\n              >\n                Add to Cart\n              </button>\n\n              <hr />\n\n              <p>\n                Status:{' '}\n                <span\n                  id='stock_status'\n                  className={product.stock > 0 ? 'greenColor' : 'redColor'}\n                >\n                  {product.stock > 0 ? 'In Stock' : 'Out of Stock'}\n                </span>\n              </p>\n\n              <hr />\n\n              <p>\n                Quantity:{' '}\n                <span\n                  id='quantity_status'\n                  className={product.stock > 0 ? 'greenColor' : 'redColor'}\n                >\n                  {product.stock}\n                </span>\n              </p>\n\n              <hr />\n\n              <h4 className='mt-2'>Description:</h4>\n              <p>{product.description}</p>\n              <hr />\n              <p id='product_seller mb-3'>\n                Sold by: <strong>{product.seller}</strong>\n              </p>\n\n              {user ? (\n                <button\n                  id='review_btn'\n                  type='button'\n                  className='btn btn-primary mt-4'\n                  data-toggle='modal'\n                  data-target='#ratingModal'\n                  onClick={setUserRatings}\n                >\n                  Submit Your Review\n                </button>\n              ) : (\n                <div className='alert alert-danger mt-5' type='alert'>\n                  Login to post your review.\n                </div>\n              )}\n\n              <div className='row mt-2 mb-5'>\n                <div className='rating w-50'>\n                  <div\n                    className='modal fade'\n                    id='ratingModal'\n                    tabIndex='-1'\n                    role='dialog'\n                    aria-labelledby='ratingModalLabel'\n                    aria-hidden='true'\n                  >\n                    <div className='modal-dialog' role='document'>\n                      <div className='modal-content'>\n                        <div className='modal-header'>\n                          <h5 className='modal-title' id='ratingModalLabel'>\n                            Submit Review\n                          </h5>\n                          <button\n                            type='button'\n                            className='close'\n                            data-dismiss='modal'\n                            aria-label='Close'\n                          >\n                            <span aria-hidden='true'>&times;</span>\n                          </button>\n                        </div>\n                        <div className='modal-body'>\n                          <ul className='stars'>\n                            <li className='star'>\n                              <i className='fa fa-star'></i>\n                            </li>\n                            <li className='star'>\n                              <i className='fa fa-star'></i>\n                            </li>\n                            <li className='star'>\n                              <i className='fa fa-star'></i>\n                            </li>\n                            <li className='star'>\n                              <i className='fa fa-star'></i>\n                            </li>\n                            <li className='star'>\n                              <i className='fa fa-star'></i>\n                            </li>\n                          </ul>\n\n                          <textarea\n                            name='review'\n                            id='review'\n                            className='form-control mt-3'\n                            value={comment}\n                            onChange={(e) => setComment(e.target.value)}\n                          ></textarea>\n\n                          <button\n                            className='btn my-3 float-right review-btn px-4 text-white'\n                            onClick={reviewHandler}\n                            data-dismiss='modal'\n                            aria-label='Close'\n                          >\n                            Submit\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {product.reviews && product.reviews.length > 0 && (\n            <ListReviews reviews={product.reviews} />\n          )}\n        </Fragment>\n      )}\n    </Fragment>\n  );\n};\n\nexport default ProductDetails;\n"]},"metadata":{},"sourceType":"module"}