{"ast":null,"code":"import _slicedToArray from\"/home/douglas/Downloads/ProShop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useEffect}from'react';import MetaData from'../layout/MetaData';import{useAlert}from'react-alert';import{useDispatch,useSelector}from'react-redux';import{updateProfile,loadUser,clearErrors}from'../../actions/userActions';import{UPDATE_PROFILE_RESET}from'../../constants/userConstants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdateProfile=function UpdateProfile(_ref){var history=_ref.history;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),avatar=_useState6[0],setAvatar=_useState6[1];var _useState7=useState('/images/default_avatar.jpg'),_useState8=_slicedToArray(_useState7,2),avatarPreview=_useState8[0],setAvatarPreview=_useState8[1];var alert=useAlert();var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.auth;}),user=_useSelector.user;var _useSelector2=useSelector(function(state){return state.user;}),error=_useSelector2.error,isUpdated=_useSelector2.isUpdated,loading=_useSelector2.loading;useEffect(function(){if(user){setName(user.name);setEmail(user.email);setAvatarPreview(user.avatar.url);}if(error){alert.error(error);dispatch(clearErrors());}if(isUpdated){alert.success('User updated successfully');dispatch(loadUser());history.push('/me');dispatch({type:UPDATE_PROFILE_RESET});}},[dispatch,alert,error,history,isUpdated]);var submitHandler=function submitHandler(e){e.preventDefault();var formData=new FormData();formData.set('name',name);formData.set('email',email);formData.set('avatar',avatar);dispatch(updateProfile(formData));};var onChange=function onChange(e){var reader=new FileReader();reader.onload=function(){if(reader.readyState===2){setAvatarPreview(reader.result);setAvatar(reader.result);}};reader.readAsDataURL(e.target.files[0]);};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MetaData,{title:'Update Profile'}),/*#__PURE__*/_jsx(\"div\",{className:\"row wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-10 col-lg-5\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"shadow-lg\",onSubmit:submitHandler,encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mt-2 mb-5\",children:\"Update Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email_field\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"name\",id:\"name_field\",className:\"form-control\",name:\"name\",value:name,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email_field\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email_field\",className:\"form-control\",name:\"email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"avatar_upload\",children:\"Avatar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"figure\",{className:\"avatar mr-3 item-rtl\",children:/*#__PURE__*/_jsx(\"img\",{src:avatarPreview,className:\"rounded-circle\",alt:\"Avatar Preview\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-file\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"avatar\",className:\"custom-file-input\",id:\"customFile\",accept:\"image/*\",onChange:onChange}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-file-label\",htmlFor:\"customFile\",children:\"Choose Avatar\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn update-btn btn-block mt-4 mb-3\",disabled:loading?true:false,children:\"Update\"})]})})})]});};export default UpdateProfile;","map":{"version":3,"sources":["/home/douglas/Downloads/ProShop/frontend/src/components/user/UpdateProfile.js"],"names":["React","Fragment","useState","useEffect","MetaData","useAlert","useDispatch","useSelector","updateProfile","loadUser","clearErrors","UPDATE_PROFILE_RESET","UpdateProfile","history","name","setName","email","setEmail","avatar","setAvatar","avatarPreview","setAvatarPreview","alert","dispatch","state","auth","user","error","isUpdated","loading","url","success","push","type","submitHandler","e","preventDefault","formData","FormData","set","onChange","reader","FileReader","onload","readyState","result","readAsDataURL","target","files","value"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react';\n\nimport MetaData from '../layout/MetaData';\n\nimport { useAlert } from 'react-alert';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  updateProfile,\n  loadUser,\n  clearErrors,\n} from '../../actions/userActions';\nimport { UPDATE_PROFILE_RESET } from '../../constants/userConstants';\n\nconst UpdateProfile = ({ history }) => {\n  const [name, setName] = useState('');\n  const [email, setEmail] = useState('');\n  const [avatar, setAvatar] = useState('');\n  const [avatarPreview, setAvatarPreview] = useState(\n    '/images/default_avatar.jpg'\n  );\n\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  const { user } = useSelector((state) => state.auth);\n  const { error, isUpdated, loading } = useSelector((state) => state.user);\n\n  useEffect(() => {\n    if (user) {\n      setName(user.name);\n      setEmail(user.email);\n      setAvatarPreview(user.avatar.url);\n    }\n\n    if (error) {\n      alert.error(error);\n      dispatch(clearErrors());\n    }\n\n    if (isUpdated) {\n      alert.success('User updated successfully');\n      dispatch(loadUser());\n\n      history.push('/me');\n\n      dispatch({\n        type: UPDATE_PROFILE_RESET,\n      });\n    }\n  }, [dispatch, alert, error, history, isUpdated]);\n\n  const submitHandler = (e) => {\n    e.preventDefault();\n\n    const formData = new FormData();\n    formData.set('name', name);\n    formData.set('email', email);\n    formData.set('avatar', avatar);\n\n    dispatch(updateProfile(formData));\n  };\n\n  const onChange = (e) => {\n    const reader = new FileReader();\n\n    reader.onload = () => {\n      if (reader.readyState === 2) {\n        setAvatarPreview(reader.result);\n        setAvatar(reader.result);\n      }\n    };\n\n    reader.readAsDataURL(e.target.files[0]);\n  };\n  return (\n    <Fragment>\n      <MetaData title={'Update Profile'} />\n\n      <div className='row wrapper'>\n        <div className='col-10 col-lg-5'>\n          <form\n            className='shadow-lg'\n            onSubmit={submitHandler}\n            encType='multipart/form-data'\n          >\n            <h1 className='mt-2 mb-5'>Update Profile</h1>\n\n            <div className='form-group'>\n              <label htmlFor='email_field'>Name</label>\n              <input\n                type='name'\n                id='name_field'\n                className='form-control'\n                name='name'\n                value={name}\n                onChange={(e) => setName(e.target.value)}\n              />\n            </div>\n\n            <div className='form-group'>\n              <label htmlFor='email_field'>Email</label>\n              <input\n                type='email'\n                id='email_field'\n                className='form-control'\n                name='email'\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n              />\n            </div>\n\n            <div className='form-group'>\n              <label htmlFor='avatar_upload'>Avatar</label>\n              <div className='d-flex align-items-center'>\n                <div>\n                  <figure className='avatar mr-3 item-rtl'>\n                    <img\n                      src={avatarPreview}\n                      className='rounded-circle'\n                      alt='Avatar Preview'\n                    />\n                  </figure>\n                </div>\n                <div className='custom-file'>\n                  <input\n                    type='file'\n                    name='avatar'\n                    className='custom-file-input'\n                    id='customFile'\n                    accept='image/*'\n                    onChange={onChange}\n                  />\n                  <label className='custom-file-label' htmlFor='customFile'>\n                    Choose Avatar\n                  </label>\n                </div>\n              </div>\n            </div>\n\n            <button\n              type='submit'\n              className='btn update-btn btn-block mt-4 mb-3'\n              disabled={loading ? true : false}\n            >\n              Update\n            </button>\n          </form>\n        </div>\n      </div>\n    </Fragment>\n  );\n};\n\nexport default UpdateProfile;\n"]},"metadata":{},"sourceType":"module"}