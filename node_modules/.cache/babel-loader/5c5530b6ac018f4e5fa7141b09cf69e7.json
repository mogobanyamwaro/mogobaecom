{"ast":null,"code":"import _toConsumableArray from\"/home/douglas/Downloads/ProShop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/douglas/Downloads/ProShop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useEffect}from'react';import MetaData from'../layout/MetaData';import Sidebar from'./Sidebar';import{useAlert}from'react-alert';import{useDispatch,useSelector}from'react-redux';import{updateProduct,getProductDetails,clearErrors}from'../../actions/productActions';import{UPDATE_PRODUCT_RESET}from'../../constants/productConstants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdateProduct=function UpdateProduct(_ref){var match=_ref.match,history=_ref.history;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),price=_useState4[0],setPrice=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),description=_useState6[0],setDescription=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),stock=_useState10[0],setStock=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),seller=_useState12[0],setSeller=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),images=_useState14[0],setImages=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),oldImages=_useState16[0],setOldImages=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),imagesPreview=_useState18[0],setImagesPreview=_useState18[1];var categories=['Electronics','Cameras','Laptops','Accessories','Headphones','Food',\"Books\",'Clothes/Shoes','Beauty/Health','Sports','Outdoor','Home'];var alert=useAlert();var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.productDetails;}),error=_useSelector.error,product=_useSelector.product;var _useSelector2=useSelector(function(state){return state.product;}),loading=_useSelector2.loading,updateError=_useSelector2.error,isUpdated=_useSelector2.isUpdated;var productId=match.params.id;useEffect(function(){if(product&&product._id!==productId){dispatch(getProductDetails(productId));}else{setName(product.name);setPrice(product.price);setDescription(product.description);setCategory(product.category);setSeller(product.seller);setStock(product.stock);setOldImages(product.images);}if(error){alert.error(error);dispatch(clearErrors());}if(updateError){alert.error(updateError);dispatch(clearErrors());}if(isUpdated){history.push('/admin/products');alert.success('Product updated successfully');dispatch({type:UPDATE_PRODUCT_RESET});}},[dispatch,alert,error,isUpdated,history,updateError,product,productId]);var submitHandler=function submitHandler(e){e.preventDefault();var formData=new FormData();formData.set('name',name);formData.set('price',price);formData.set('description',description);formData.set('category',category);formData.set('stock',stock);formData.set('seller',seller);images.forEach(function(image){formData.append('images',image);});dispatch(updateProduct(product._id,formData));};var onChange=function onChange(e){var files=Array.from(e.target.files);setImagesPreview([]);setImages([]);setOldImages([]);files.forEach(function(file){var reader=new FileReader();reader.onload=function(){if(reader.readyState===2){setImagesPreview(function(oldArray){return[].concat(_toConsumableArray(oldArray),[reader.result]);});setImages(function(oldArray){return[].concat(_toConsumableArray(oldArray),[reader.result]);});}};reader.readAsDataURL(file);});};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MetaData,{title:'Update Product'}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-md-2\",children:/*#__PURE__*/_jsx(Sidebar,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-md-10\",children:/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"wrapper my-5\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"shadow-lg\",onSubmit:submitHandler,encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-4\",children:\"Update Product\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name_field\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name_field\",className:\"form-control\",value:name,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"price_field\",children:\"Price\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"price_field\",className:\"form-control\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"description_field\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",id:\"description_field\",rows:\"8\",value:description,onChange:function onChange(e){return setDescription(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"category_field\",children:\"Category\"}),/*#__PURE__*/_jsx(\"select\",{className:\"form-control\",id:\"category_field\",value:category,onChange:function onChange(e){return setCategory(e.target.value);},children:categories.map(function(category){return/*#__PURE__*/_jsx(\"option\",{value:category,children:category},category);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"stock_field\",children:\"Stock\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"stock_field\",className:\"form-control\",value:stock,onChange:function onChange(e){return setStock(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"seller_field\",children:\"Seller Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"seller_field\",className:\"form-control\",value:seller,onChange:function onChange(e){return setSeller(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Images\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-file\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"product_images\",className:\"custom-file-input\",id:\"customFile\",onChange:onChange,multiple:true}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-file-label\",htmlFor:\"customFile\",children:\"Choose Images\"})]}),oldImages&&oldImages.map(function(img){return/*#__PURE__*/_jsx(\"img\",{src:img.url,alt:img.url,className:\"mt-3 mr-2\",width:\"55\",height:\"52\"},img);}),imagesPreview.map(function(img){return/*#__PURE__*/_jsx(\"img\",{src:img,alt:\"Images Preview\",className:\"mt-3 mr-2\",width:\"55\",height:\"52\"},img);})]}),/*#__PURE__*/_jsx(\"button\",{id:\"login_button\",type:\"submit\",className:\"btn btn-block py-3\",disabled:loading?true:false,children:\"UPDATE\"})]})})})})]})]});};export default UpdateProduct;","map":{"version":3,"sources":["/home/douglas/Downloads/ProShop/frontend/src/components/admin/UpdateProduct.js"],"names":["React","Fragment","useState","useEffect","MetaData","Sidebar","useAlert","useDispatch","useSelector","updateProduct","getProductDetails","clearErrors","UPDATE_PRODUCT_RESET","UpdateProduct","match","history","name","setName","price","setPrice","description","setDescription","category","setCategory","stock","setStock","seller","setSeller","images","setImages","oldImages","setOldImages","imagesPreview","setImagesPreview","categories","alert","dispatch","state","productDetails","error","product","loading","updateError","isUpdated","productId","params","id","_id","push","success","type","submitHandler","e","preventDefault","formData","FormData","set","forEach","image","append","onChange","files","Array","from","target","file","reader","FileReader","onload","readyState","oldArray","result","readAsDataURL","value","map","img","url"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react'\n\nimport MetaData from '../layout/MetaData'\nimport Sidebar from './Sidebar'\n\nimport { useAlert } from 'react-alert'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { updateProduct, getProductDetails, clearErrors } from '../../actions/productActions'\nimport { UPDATE_PRODUCT_RESET } from '../../constants/productConstants'\n\nconst UpdateProduct = ({ match, history }) => {\n\n    const [name, setName] = useState('');\n    const [price, setPrice] = useState(0);\n    const [description, setDescription] = useState('');\n    const [category, setCategory] = useState('');\n    const [stock, setStock] = useState(0);\n    const [seller, setSeller] = useState('');\n    const [images, setImages] = useState([]);\n\n    const [oldImages, setOldImages] = useState([]);\n    const [imagesPreview, setImagesPreview] = useState([])\n\n    const categories = [\n        'Electronics',\n        'Cameras',\n        'Laptops',\n        'Accessories',\n        'Headphones',\n        'Food',\n        \"Books\",\n        'Clothes/Shoes',\n        'Beauty/Health',\n        'Sports',\n        'Outdoor',\n        'Home'\n    ]\n\n    const alert = useAlert();\n    const dispatch = useDispatch();\n\n    const { error, product } = useSelector(state => state.productDetails)\n    const { loading, error: updateError, isUpdated } = useSelector(state => state.product);\n\n    const productId = match.params.id;\n\n    useEffect(() => {\n\n        if (product && product._id !== productId) {\n            dispatch(getProductDetails(productId));\n        } else {\n            setName(product.name);\n            setPrice(product.price);\n            setDescription(product.description);\n            setCategory(product.category);\n            setSeller(product.seller);\n            setStock(product.stock)\n            setOldImages(product.images)\n        }\n\n        if (error) {\n            alert.error(error);\n            dispatch(clearErrors())\n        }\n\n        if (updateError) {\n            alert.error(updateError);\n            dispatch(clearErrors())\n        }\n\n\n        if (isUpdated) {\n            history.push('/admin/products');\n            alert.success('Product updated successfully');\n            dispatch({ type: UPDATE_PRODUCT_RESET })\n        }\n\n    }, [dispatch, alert, error, isUpdated, history, updateError, product, productId])\n\n\n    const submitHandler = (e) => {\n        e.preventDefault();\n\n        const formData = new FormData();\n        formData.set('name', name);\n        formData.set('price', price);\n        formData.set('description', description);\n        formData.set('category', category);\n        formData.set('stock', stock);\n        formData.set('seller', seller);\n\n        images.forEach(image => {\n            formData.append('images', image)\n        })\n\n        dispatch(updateProduct(product._id, formData))\n    }\n\n    const onChange = e => {\n\n        const files = Array.from(e.target.files)\n\n        setImagesPreview([]);\n        setImages([])\n        setOldImages([])\n\n        files.forEach(file => {\n            const reader = new FileReader();\n\n            reader.onload = () => {\n                if (reader.readyState === 2) {\n                    setImagesPreview(oldArray => [...oldArray, reader.result])\n                    setImages(oldArray => [...oldArray, reader.result])\n                }\n            }\n\n            reader.readAsDataURL(file)\n        })\n    }\n\n\n    return (\n        <Fragment>\n            <MetaData title={'Update Product'} />\n            <div className=\"row\">\n                <div className=\"col-12 col-md-2\">\n                    <Sidebar />\n                </div>\n\n                <div className=\"col-12 col-md-10\">\n                    <Fragment>\n                        <div className=\"wrapper my-5\">\n                            <form className=\"shadow-lg\" onSubmit={submitHandler} encType='multipart/form-data'>\n                                <h1 className=\"mb-4\">Update Product</h1>\n\n                                <div className=\"form-group\">\n                                    <label htmlFor=\"name_field\">Name</label>\n                                    <input\n                                        type=\"text\"\n                                        id=\"name_field\"\n                                        className=\"form-control\"\n                                        value={name}\n                                        onChange={(e) => setName(e.target.value)}\n                                    />\n                                </div>\n\n                                <div className=\"form-group\">\n                                    <label htmlFor=\"price_field\">Price</label>\n                                    <input\n                                        type=\"text\"\n                                        id=\"price_field\"\n                                        className=\"form-control\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value)}\n                                    />\n                                </div>\n\n                                <div className=\"form-group\">\n                                    <label htmlFor=\"description_field\">Description</label>\n                                    <textarea className=\"form-control\" id=\"description_field\" rows=\"8\" value={description} onChange={(e) => setDescription(e.target.value)}></textarea>\n                                </div>\n\n                                <div className=\"form-group\">\n                                    <label htmlFor=\"category_field\">Category</label>\n                                    <select className=\"form-control\" id=\"category_field\" value={category} onChange={(e) => setCategory(e.target.value)}>\n                                        {categories.map(category => (\n                                            <option key={category} value={category} >{category}</option>\n                                        ))}\n\n                                    </select>\n                                </div>\n                                <div className=\"form-group\">\n                                    <label htmlFor=\"stock_field\">Stock</label>\n                                    <input\n                                        type=\"number\"\n                                        id=\"stock_field\"\n                                        className=\"form-control\"\n                                        value={stock}\n                                        onChange={(e) => setStock(e.target.value)}\n                                    />\n                                </div>\n\n                                <div className=\"form-group\">\n                                    <label htmlFor=\"seller_field\">Seller Name</label>\n                                    <input\n                                        type=\"text\"\n                                        id=\"seller_field\"\n                                        className=\"form-control\"\n                                        value={seller}\n                                        onChange={(e) => setSeller(e.target.value)}\n                                    />\n                                </div>\n\n                                <div className='form-group'>\n                                    <label>Images</label>\n\n                                    <div className='custom-file'>\n                                        <input\n                                            type='file'\n                                            name='product_images'\n                                            className='custom-file-input'\n                                            id='customFile'\n                                            onChange={onChange}\n                                            multiple\n                                        />\n                                        <label className='custom-file-label' htmlFor='customFile'>\n                                            Choose Images\n                                 </label>\n                                    </div>\n\n                                    {oldImages && oldImages.map(img => (\n                                        <img key={img} src={img.url} alt={img.url} className=\"mt-3 mr-2\" width=\"55\" height=\"52\" />\n                                    ))}\n\n                                    {imagesPreview.map(img => (\n                                        <img src={img} key={img} alt=\"Images Preview\" className=\"mt-3 mr-2\" width=\"55\" height=\"52\" />\n                                    ))}\n\n                                </div>\n\n\n                                <button\n                                    id=\"login_button\"\n                                    type=\"submit\"\n                                    className=\"btn btn-block py-3\"\n                                    disabled={loading ? true : false}\n                                >\n                                    UPDATE\n                            </button>\n\n                            </form>\n                        </div>\n                    </Fragment>\n                </div>\n            </div>\n\n        </Fragment>\n    )\n}\n\nexport default UpdateProduct\n"]},"metadata":{},"sourceType":"module"}